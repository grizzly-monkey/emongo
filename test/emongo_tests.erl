%%%-------------------------------------------------------------------
%%% @author mayuresh
%%% @copyright (C) 2019, <COMPANY>
%%% @doc
%%%
%%% @end
%%% Created : 24. Jan 2019 4:55 PM
%%%-------------------------------------------------------------------
-module(emongo_tests).
-author("mayuresh").
-include_lib("eunit/include/eunit.hrl").

-define(DBS, "students").
-define(COL, "stud_info").
-define(Tenant, tenant).

data_prep_test_() ->
  [
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.12 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.28 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.98 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.51 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.24 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.56 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.67 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.96 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.20 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.96 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.86 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.44 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.11 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.36 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.81 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.72 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.41 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.77 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.88 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.68 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.11 }"), {ok, "true"}),
    ?_assertEqual(emongo:insert(?COL, "{\"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.06 }"), {ok, "true"})
  ].

count_test_() ->
  [
    ?_assertEqual(emongo:count(?DBS, ?COL, "{}"), {ok, "22"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"name\" : \"Billy\"}"), {ok, "1"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"roll_no\" : { \"$gt\": 7 } }"), {ok, "15"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"standard\" : { \"$gte\": 5 } }"), {ok, "14"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"roll_no\" : { \"$lt\": 14 } }"), {ok, "13"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"standard\" : { \"$lte\": 5 } }"), {ok, "11"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"roll_no\" : { \"$lt\": 22 }, \"roll_no\" : { \"$gt\": 10 } }"), {ok, "11"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"roll_no\" : { \"$lte\": 8 }, \"standard\" : { \"$gte\": 4 } }"), {ok, "6"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"$and\": [ {\"name\": \"Warren\"}, {\"standard\": 3 } ] }"), {ok, "1"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"$or\": [ {\"roll_no\": 17 }, {\"standard\": 9 } ] }"), {ok, "3"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"$or\": [ {\"roll_no\": {\"$gt\":12} }, {\"standard\": {\"$lt\":6} } ] }"), {ok, "15"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"roll_no\": {\"$gt\":10}, \"$or\": [{\"division\": \"B\"},{\"standard\": {\"$lt\":6}}]}"), {ok, "8"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{}", #{collation=>"{ \"locale\": \"en_US\", \"strength\": 1}"}), {ok, "22"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"division\" : \"C\"}", #{collation=>"{ \"locale\": \"en_US\", \"strength\": 1, \"normalization\": true}"}), {ok, "7"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"division\" : \"C\"}", #{collation=>"{ \"locale\": \"en_US\", \"backwards\": true}"}), {ok, "7"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"standard\" : 4.0}", #{collation=>"{ \"locale\": \"en_US\", \"alternate\": \"shifted\"}"}), {ok, "2"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"name\" : \"John\"}", #{collation=>"{ \"locale\": \"en_US\", \"caseLevel\": true }"}), {ok, "1"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{\"division\" : \"B\"}", #{skip=>3}), {ok, "4"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"A\" }", #{limit => 5}), {ok, "5"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"A\" }", #{max_time => 1}), {ok, "8"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"A\" }", #{limit => 3, skip=> 2}), {ok, "3"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"B\" }", #{limit => 3, max_time=> 5}), {ok, "3"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"B\" }", #{skip => 3, max_time=> 5}), {ok, "4"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"A\" }", #{limit => 3, skip=> 2, max_time=> 2}), {ok, "3"}),
    ?_assertEqual(emongo:count(?DBS, ?COL, "{ \"division\" : \"A\" }", #{limit => 3, skip=> 2, max_time=> 2, collation => "{ \"locale\": \"en_US\", \"strength\": 2, \"normalization\": true, \"backwards\": true, \"caseLevel\": true }"}), {ok, "3"}),
    ?_assertNotEqual(emongo:count(students, ?COL, "{\"name\" : \"Billy\"}"), {"{ error , \"Invalid Database Name: Invalid argument\" }"}),
    ?_assertNotEqual(emongo:count(?DBS, stud, "{\"name\" : \"Billy\"}"), {"{ error , \"Invalid Collection Name: Invalid argument\" }"}),
    ?_assertNotEqual(emongo:count(?DBS, ?COL, "{\"name\" : Billy}"), {"{ error , \"Unknown Exception\" }"}),
    ?_assertNotEqual(emongo:count(?DBS, ?COL, "{name: \"Billy\"}"), {"{ error , \"Unknown Exception\" }"}),
    ?_assertNotEqual(emongo:count(?DBS, ?COL, "{ \"roll_no\" : { $gt: 21 } }"), {"{ error , \"Unknown Exception\" }"})
  ].

exists_test_() ->
  [
    ?_assertEqual(emongo:exists(?COL, "{\"name\" : \"Billy\"}"), {ok, "true"}),
    ?_assertEqual(emongo:exists(?COL, "{\"name\" : \"Bill\"}"), {ok, "false"}),
    ?_assertEqual(emongo:exists(?COL, "{\"standard\" : 5 }"), {ok, "true"}),
    ?_assertEqual(emongo:exists(?COL, "{\"division\" :  \"B\" }"), {ok, "true"}),
    ?_assertEqual(emongo:exists(?COL, "{\"division\" :  \"D\" }"), {ok, "false"}),
    ?_assertEqual(emongo:exists(?COL, "{\"roll_no\" :  22 }"), {ok, "true"}),
    ?_assertNotEqual(emongo:exists(?COL, "{\"name\" : Billy}"), {"{ error , \"Unknown Exception\" }"}),
    ?_assertNotEqual(emongo:exists(stud, "{\"name\" : \"Billy\"}"), {"{ error , \"Invalid Collection Name: Invalid argument\" }"})
  ].

find_test_() ->
  [
    ?_assertEqual(emongo:find(?COL, "{}"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"A\" }"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 }]"}),
    ?_assertEqual(emongo:find(?COL, "{\"name\" : \"Ketan\"}"), {ok, "[{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"roll_no\" : { \"$gt\": 7 } }"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"standard\" : { \"$gte\": 5 } }"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"roll_no\" : { \"$lt\": 14 } }"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"standard\" : { \"$lte\": 5 } }"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"$and\": [ {\"name\": \"Warren\"}, {\"standard\": 3 } ] }"), {ok, "[{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"$or\": [ {\"roll_no\": 17 }, {\"standard\": 9 } ] }"), {ok, "[{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"$or\": [ {\"roll_no\": {\"$gt\":12} }, {\"standard\": {\"$lt\":6} } ] }"), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find(?COL, "{\"roll_no\": {\"$gt\":10}, \"$or\": [{\"division\": \"B\"},{\"standard\": {\"$lt\":6}}]}"), {ok, "[{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 }]"}),
    ?_assertEqual(emongo:find(?COL, "{\"standard\" : 6}", #{sort => "{\"name\": 1}"}), {ok, "[{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"C\" }", #{sort => "{\"roll_no\": -1}"}), {ok, "[{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 }]"}),
    ?_assertEqual(emongo:find(?COL, "{\"standard\" : {\"$gte\": 7}}", #{comment=>"{ \"students from standard 7th and greater\"}"}), {ok, "[{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"roll_no\" : 18 }", #{allow_partial_results=> true}), {ok, "[{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"roll_no\" : 20 }", #{max_await_time=> 10}), {ok, "[{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"C\" }", #{limit=> 3}), {ok, "[{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"A\" }", #{sort => "{\"roll_no\": -1}", limit=> 3}), {ok, "[{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"standard\" : 5 }", #{show_record_id=> true}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066, \"$recordId\" : 1 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197, \"$recordId\" : 11 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316, \"$recordId\" : 14 }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"C\" }", #{projection => "{\"name\": 1}"}), {ok, "[{ \"_id\" : \"29846\", \"name\" : \"Piyush\" },{ \"_id\" : \"29847\", \"name\" : \"Denice\" },{ \"_id\" : \"29848\", \"name\" : \"Pranali\" },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\" },{ \"_id\" : \"29850\", \"name\" : \"Warren\" },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\" },{ \"_id\" : \"29852\", \"name\" : \"Billy\" }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"B\" }", #{projection => "{\"name\": 1}", limit => 2}), {ok, "[{ \"_id\" : \"29832\", \"name\" : \"Pooja\" },{ \"_id\" : \"29833\", \"name\" : \"Mary\" }]"}),
    ?_assertEqual(emongo:find(?COL, "{ \"division\" : \"B\" }", #{projection => "{\"name\": 1}", max_await_time => 10}), {ok, "[{ \"_id\" : \"29832\", \"name\" : \"Pooja\" },{ \"_id\" : \"29833\", \"name\" : \"Mary\" },{ \"_id\" : \"29834\", \"name\" : \"Parag\" },{ \"_id\" : \"29835\", \"name\" : \"Alex\" },{ \"_id\" : \"29836\", \"name\" : \"Prashant\" },{ \"_id\" : \"29837\", \"name\" : \"Vishal\" },{ \"_id\" : \"29838\", \"name\" : \"Rohit\" }]"}),
    ?_assertNotEqual(emongo:find(stud, "{ \"division\" : \"C\" }"), {"{ error , \"Invalid Collection Name: Invalid argument\" }"}),
    ?_assertNotEqual(emongo:find(?COL, "{ \"division\" : C }"), {"{ error , \"Unknown Exception\" }"}),
    ?_assertNotEqual(emongo:find(?COL, "{ division : \"C\" }"), {"{ error , \"Unknown Exception\" }"}),
    ?_assertNotEqual(emongo:find(?COL, "{ \"roll_no\" : 18 }", #{skip => -1}), {error}),
    ?_assertNotEqual(emongo:find(?COL, "{ \"division\" : \"B\" }", #{projection => "{\"name\"}"}), {{error, "Got parse error at \"}\", position 7: \"VALUE_EXPECTED\": could not parse JSON document"}}),
    ?_assertNotEqual(emongo:find(?COL, "{ \"division\" : \"C\" }", #{sort => "{roll_no: -1}"}), {{error, "Got parse error at \"r\", position 1: \"SPECIAL_EXPECTED\": could not parse JSON document"}}),
    ?_assertNotEqual(emongo:find(?COL, "{ \"roll_no\" : 18 }", #{limit => -1}), {{error, "Limit value must be non-negative, but received: -1: generic server error"}}),
    ?_assertNotEqual(emongo:find(?COL, #{skip => 2}), {"{ error , \"Invalid Collection Name: Invalid argument\" }"})
  ].

find_all_test_() ->
  [
    ?_assertEqual(emongo:find_all(?COL), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find_all("invoice"), {ok, []}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"standard\": 1}"}), {ok, "[{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"roll_no\": 1}"}), {ok, "[{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"roll_no\": -1}"}), {ok, "[{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{skip => 2}), {ok, "[{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"roll_no\": 1}", skip => 1}), {ok, "[{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"standard\": -1}", skip => 2}), {ok, "[{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{limit => 5}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{projection => "{\"name\": 1}"}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\" },{ \"_id\" : \"29832\", \"name\" : \"Pooja\" },{ \"_id\" : \"29833\", \"name\" : \"Mary\" },{ \"_id\" : \"29834\", \"name\" : \"Parag\" },{ \"_id\" : \"29835\", \"name\" : \"Alex\" },{ \"_id\" : \"29836\", \"name\" : \"Prashant\" },{ \"_id\" : \"29837\", \"name\" : \"Vishal\" },{ \"_id\" : \"29838\", \"name\" : \"Rohit\" },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\" },{ \"_id\" : \"29840\", \"name\" : \"Richa\" },{ \"_id\" : \"29841\", \"name\" : \"Manali\" },{ \"_id\" : \"29842\", \"name\" : \"Swati\" },{ \"_id\" : \"29843\", \"name\" : \"Dexter\" },{ \"_id\" : \"29844\", \"name\" : \"Ketan\" },{ \"_id\" : \"29845\", \"name\" : \"Mark\" },{ \"_id\" : \"29846\", \"name\" : \"Piyush\" },{ \"_id\" : \"29847\", \"name\" : \"Denice\" },{ \"_id\" : \"29848\", \"name\" : \"Pranali\" },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\" },{ \"_id\" : \"29850\", \"name\" : \"Warren\" },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\" },{ \"_id\" : \"29852\", \"name\" : \"Billy\" }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"standard\": -1}", skip => 2, limit => 5, projection => "{\"name\": 1}"}), {ok, "[{ \"_id\" : \"29832\", \"name\" : \"Pooja\" },{ \"_id\" : \"29843\", \"name\" : \"Dexter\" },{ \"_id\" : \"29848\", \"name\" : \"Pranali\" },{ \"_id\" : \"29836\", \"name\" : \"Prashant\" },{ \"_id\" : \"29837\", \"name\" : \"Vishal\" }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{show_record_id => true}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066, \"$recordId\" : 1 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266, \"$recordId\" : 2 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263, \"$recordId\" : 3 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868, \"$recordId\" : 4 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132, \"$recordId\" : 5 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092, \"$recordId\" : 6 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289, \"$recordId\" : 7 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645, \"$recordId\" : 8 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776, \"$recordId\" : 9 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645, \"$recordId\" : 10 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197, \"$recordId\" : 11 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467, \"$recordId\" : 12 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757, \"$recordId\" : 13 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316, \"$recordId\" : 14 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533, \"$recordId\" : 15 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954, \"$recordId\" : 16 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421, \"$recordId\" : 17 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178, \"$recordId\" : 18 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934, \"$recordId\" : 19 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599, \"$recordId\" : 20 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316, \"$recordId\" : 21 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092, \"$recordId\" : 22 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{allow_partial_results=> true}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{sort => "{\"standard\": -1}", show_record_id => true, limit => 5}), {ok, "[{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263, \"$recordId\" : 3 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467, \"$recordId\" : 12 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266, \"$recordId\" : 2 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757, \"$recordId\" : 13 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178, \"$recordId\" : 18 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{projection => "{\"name\": 1}"}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\" },{ \"_id\" : \"29832\", \"name\" : \"Pooja\" },{ \"_id\" : \"29833\", \"name\" : \"Mary\" },{ \"_id\" : \"29834\", \"name\" : \"Parag\" },{ \"_id\" : \"29835\", \"name\" : \"Alex\" },{ \"_id\" : \"29836\", \"name\" : \"Prashant\" },{ \"_id\" : \"29837\", \"name\" : \"Vishal\" },{ \"_id\" : \"29838\", \"name\" : \"Rohit\" },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\" },{ \"_id\" : \"29840\", \"name\" : \"Richa\" },{ \"_id\" : \"29841\", \"name\" : \"Manali\" },{ \"_id\" : \"29842\", \"name\" : \"Swati\" },{ \"_id\" : \"29843\", \"name\" : \"Dexter\" },{ \"_id\" : \"29844\", \"name\" : \"Ketan\" },{ \"_id\" : \"29845\", \"name\" : \"Mark\" },{ \"_id\" : \"29846\", \"name\" : \"Piyush\" },{ \"_id\" : \"29847\", \"name\" : \"Denice\" },{ \"_id\" : \"29848\", \"name\" : \"Pranali\" },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\" },{ \"_id\" : \"29850\", \"name\" : \"Warren\" },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\" },{ \"_id\" : \"29852\", \"name\" : \"Billy\" }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{projection => "{\"name\": 1}", sort =>"{\"name\": 1}", limit => 8}), {ok, "[{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\" },{ \"_id\" : \"29835\", \"name\" : \"Alex\" },{ \"_id\" : \"29852\", \"name\" : \"Billy\" },{ \"_id\" : \"29847\", \"name\" : \"Denice\" },{ \"_id\" : \"29843\", \"name\" : \"Dexter\" },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\" },{ \"_id\" : \"29831\", \"name\" : \"John\" },{ \"_id\" : \"29844\", \"name\" : \"Ketan\" }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{return_key => true}), {ok, "[{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ },{ }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{batch_size => 5}), {ok, "[{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 },{ \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 },{ \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 },{ \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 },{ \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 },{ \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 },{ \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 },{ \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 },{ \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 },{ \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 },{ \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 },{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 },{ \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 },{ \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 },{ \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 },{ \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 },{ \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 },{ \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 },{ \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 },{ \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 },{ \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 }]"}),
    ?_assertEqual(emongo:find_all(?COL, #{projection => "{\"name\": 1}", sort =>"{\"name\": 1}", skip => 5}), {ok, "[{ \"_id\" : \"29851\", \"name\" : \"Gaurav\" },{ \"_id\" : \"29831\", \"name\" : \"John\" },{ \"_id\" : \"29844\", \"name\" : \"Ketan\" },{ \"_id\" : \"29841\", \"name\" : \"Manali\" },{ \"_id\" : \"29845\", \"name\" : \"Mark\" },{ \"_id\" : \"29833\", \"name\" : \"Mary\" },{ \"_id\" : \"29849\", \"name\" : \"Mayuresh\" },{ \"_id\" : \"29834\", \"name\" : \"Parag\" },{ \"_id\" : \"29846\", \"name\" : \"Piyush\" },{ \"_id\" : \"29832\", \"name\" : \"Pooja\" },{ \"_id\" : \"29848\", \"name\" : \"Pranali\" },{ \"_id\" : \"29836\", \"name\" : \"Prashant\" },{ \"_id\" : \"29840\", \"name\" : \"Richa\" },{ \"_id\" : \"29838\", \"name\" : \"Rohit\" },{ \"_id\" : \"29842\", \"name\" : \"Swati\" },{ \"_id\" : \"29837\", \"name\" : \"Vishal\" },{ \"_id\" : \"29850\", \"name\" : \"Warren\" }]"}),
    ?_assertNotEqual(emongo:find_all(stud_info), {"{ error , \"Invalid Collection Name: Invalid argument\" }"}),
    ?_assertNotEqual(emongo:find_all(?COL, #{projection => "{name: 1}"}), {{error, "Got parse error at \"n\", position 1: \"HKEY_EXPECTED\": could not parse JSON document"}}),
    ?_assertNotEqual(emongo:find_all(?COL, #{sort => "{standard: -1}"}), {{error, "Got parse error at \"s\", position 1: \"SPECIAL_EXPECTED\": could not parse JSON document"}}),
    ?_assertNotEqual(emongo:find_all(?COL, #{skip => -1}), {{error, "Skip value must be non-negative, but received: -1: generic server error"}}),
    ?_assertNotEqual(emongo:find_all(?COL, "{ \"roll_no\" : 20 }", #{max_await_time=> 10}), {function_clause}),
    ?_assertNotEqual(emongo:find_all(?COL, #{limit => -1}), {{error, "Limit value must be non-negative, but received: -1: generic server error"}})
  ].

find_by_id_test_() ->
  [
    ?_assertEqual(emongo:find_by_id(?COL, "29831"), {ok, "{ \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 }"}),
    ?_assertEqual(emongo:find_by_id(?COL, "29842"), {ok, "{ \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 }"}),
    ?_assertNotEqual(emongo:find_by_id(?COL, 29842), {{error, "Invalid string: Invalid argument"}})
  ].

run_command_test_() ->
  [
    ?_assertEqual(emongo:run_command(?DBS, "{ \"count\": \"stud_info\" }"), {ok, "{ \"n\" : 22, \"ok\" : 1.0 }"}),
    ?_assertEqual(emongo:run_command(?DBS, "{ \"find\": \"stud_info\" }"), {ok, "{ \"cursor\" : { \"firstBatch\" : [ { \"_id\" : \"29831\", \"name\" : \"John\", \"roll_no\" : 8.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 5.1200000000000001066 }, { \"_id\" : \"29832\", \"name\" : \"Pooja\", \"roll_no\" : 1.0, \"division\" : \"B\", \"standard\" : 8.0, \"grade\" : 1.2800000000000000266 }, { \"_id\" : \"29833\", \"name\" : \"Mary\", \"roll_no\" : 3.0, \"division\" : \"B\", \"standard\" : 9.0, \"grade\" : 6.9800000000000004263 }, { \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 }, { \"_id\" : \"29835\", \"name\" : \"Alex\", \"roll_no\" : 9.0, \"division\" : \"B\", \"standard\" : 3.0, \"grade\" : 7.2400000000000002132 }, { \"_id\" : \"29836\", \"name\" : \"Prashant\", \"roll_no\" : 10.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 4.5599999999999996092 }, { \"_id\" : \"29837\", \"name\" : \"Vishal\", \"roll_no\" : 13.0, \"division\" : \"B\", \"standard\" : 7.0, \"grade\" : 8.6699999999999999289 }, { \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 }, { \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 }, { \"_id\" : \"29840\", \"name\" : \"Richa\", \"roll_no\" : 11.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 6.9599999999999999645 }, { \"_id\" : \"29841\", \"name\" : \"Manali\", \"roll_no\" : 12.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 7.8600000000000003197 }, { \"_id\" : \"29842\", \"name\" : \"Swati\", \"roll_no\" : 14.0, \"division\" : \"A\", \"standard\" : 9.0, \"grade\" : 2.4399999999999999467 }, { \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 }, { \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 }, { \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 }, { \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 }, { \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 }, { \"_id\" : \"29848\", \"name\" : \"Pranali\", \"roll_no\" : 7.0, \"division\" : \"C\", \"standard\" : 8.0, \"grade\" : 2.7700000000000000178 }, { \"_id\" : \"29849\", \"name\" : \"Mayuresh\", \"roll_no\" : 15.0, \"division\" : \"C\", \"standard\" : 4.0, \"grade\" : 5.8799999999999998934 }, { \"_id\" : \"29850\", \"name\" : \"Warren\", \"roll_no\" : 16.0, \"division\" : \"C\", \"standard\" : 3.0, \"grade\" : 2.6800000000000001599 }, { \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 }, { \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 } ], \"id\" : 0, \"ns\" : \"students.stud_info\" }, \"ok\" : 1.0 }"}),
    ?_assertEqual(emongo:run_command(?DBS, "{ \"find\": \"stud_info\", \"filter\": { \"roll_no\": { \"$gt\": 16 }} }"), {ok, "{ \"cursor\" : { \"firstBatch\" : [ { \"_id\" : \"29838\", \"name\" : \"Rohit\", \"roll_no\" : 19.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 1.9599999999999999645 }, { \"_id\" : \"29843\", \"name\" : \"Dexter\", \"roll_no\" : 17.0, \"division\" : \"A\", \"standard\" : 8.0, \"grade\" : 3.1099999999999998757 }, { \"_id\" : \"29844\", \"name\" : \"Ketan\", \"roll_no\" : 20.0, \"division\" : \"A\", \"standard\" : 5.0, \"grade\" : 8.3599999999999994316 }, { \"_id\" : \"29845\", \"name\" : \"Mark\", \"roll_no\" : 22.0, \"division\" : \"A\", \"standard\" : 4.0, \"grade\" : 1.8100000000000000533 }, { \"_id\" : \"29851\", \"name\" : \"Gaurav\", \"roll_no\" : 18.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 9.1099999999999994316 }, { \"_id\" : \"29852\", \"name\" : \"Billy\", \"roll_no\" : 21.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 4.0599999999999996092 } ], \"id\" : 0, \"ns\" : \"students.stud_info\" }, \"ok\" : 1.0 }"}),
    ?_assertEqual(emongo:run_command(?DBS, "{ \"find\": \"stud_info\", \"filter\": { \"roll_no\": { \"$lt\": 7 }}, \"skip\": 2 }"), {ok, "{ \"cursor\" : { \"firstBatch\" : [ { \"_id\" : \"29834\", \"name\" : \"Parag\", \"roll_no\" : 5.0, \"division\" : \"B\", \"standard\" : 1.0, \"grade\" : 9.5099999999999997868 }, { \"_id\" : \"29839\", \"name\" : \"Abhijeet\", \"roll_no\" : 2.0, \"division\" : \"A\", \"standard\" : 6.0, \"grade\" : 3.2000000000000001776 }, { \"_id\" : \"29846\", \"name\" : \"Piyush\", \"roll_no\" : 4.0, \"division\" : \"C\", \"standard\" : 7.0, \"grade\" : 3.7200000000000001954 }, { \"_id\" : \"29847\", \"name\" : \"Denice\", \"roll_no\" : 6.0, \"division\" : \"C\", \"standard\" : 2.0, \"grade\" : 5.4100000000000001421 } ], \"id\" : 0, \"ns\" : \"students.stud_info\" }, \"ok\" : 1.0 }"}),
    ?_assertNotEqual(emongo:run_command(?DBS, "{ \"create\": \"dbexample\" }"), "{ ok , \"{ \\\"ok\\\" : 1.0 }\" }"),
    ?_assertNotEqual(emongo:run_command(?DBS, "{ \"drop\": \"dbexample\" }"), "{ ok , \"{ \\\"ns\\\" : \\\"students.dbexample\\\", \\\"nIndexesWas\\\" : 1, \\\"ok\\\" : 1.0 }\" }")
  ].

write_set_concern_test_() ->
  [
    ?_assertEqual(emongo:set_write_concern(?DBS, ?COL, #{}), {ok, "true"}),
    ?_assertEqual(emongo:set_write_concern(?DBS, ?COL, #{timeout=> 20}), {ok, "true"}),
    ?_assertEqual(emongo:set_write_concern(?DBS, ?COL, #{majority => 20}), {ok, "true"}),
    ?_assertEqual(emongo:set_write_concern(?DBS, ?COL, #{journal => 25}), {ok, "true"})
  ].

update_by_id_test_() ->
  [
    ?_assertEqual(emongo:update_by_id(?COL, "29834", "{ \"$set\" : {\"name\" : \"Daniel\"} }"), {ok, "1 matched and 1 documents updated."}),
    ?_assertNotEqual(emongo:update_by_id(?COL, 9834, "{ \"$set\" : {\"name\" : \"Parag\"} }"), {{error, "Invalid string: Invalid argument"}})
  ].

delete_by_id_test_() ->
  [
    ?_assertNotEqual(emongo:delete_by_id(?COL, "29834"), {{ok, "1 documents deleted."}}),
    ?_assertNotEqual(emongo:delete_by_id(?COL, 29834), {{error, "Invalid string: Invalid argument"}})
  ].

create_collection_test_() ->
  [
    ?_assertEqual(emongo:create_collection(?DBS, "invoicexy", #{}), {ok, "true"}),
    ?_assertEqual(emongo:create_collection(?DBS, "invoicey", #{capped => true, size=> 150}), {ok, "true"}),
    ?_assertEqual(emongo:create_collection(?DBS, "invoicexyz", #{capped => true, size=> 150, collation=>"{ \"locale\": \"en_US\", \"strength\": 1}"}), {ok, "true"}),
    ?_assertEqual(emongo:create_collection(?DBS, "invoicex", #{capped => true, size=> 150, max=> 15}), {ok, "true"}),
    ?_assertEqual(emongo:create_collection(?DBS, "examplee", #{validator=> "{\"$jsonSchema\": {\"bsonType\": \"object\",\"required\": [ \"name\" ],\"properties\": {\"name\": {\"bsonType\": \"string\",\"description\": \"must be a string and is required\" }}}}"}), {ok, "true"}),
    ?_assertEqual(emongo:create_collection(?DBS, "examplex", #{validator=> "{\"$jsonSchema\": {\"bsonType\": \"object\",\"required\": [ \"name\" ],\"properties\": {\"name\": {\"bsonType\": \"string\",\"description\": \"must be a string and is required\" }}}}", validation_level=> moderate, validation_action=>warn}), {ok, "true"}),
    ?_assertNotEqual(emongo:create_collection(?DBS, "invoicexa", #{capped => true, max=> 15}), {{error, "specify size:<n> when capped is true: generic server error"}}),
    ?_assertNotEqual(emongo:create_collection(?DBS, "invoicex", #{}), {{error, "a collection 'students.invoicex' already exists: generic server error"}}),
    ?_assertNotEqual(emongo:create_collection(students, "invoiceabc", #{}), {{error, "Invalid Database Name: Invalid argument"}}),
    ?_assertNotEqual(emongo:create_collection(?DBS, invoiceabc, #{}), {{error, "Invalid Collection Name: Invalid argument"}})

  ].

rename_collection_test_() ->
  [
    ?_assertEqual(emongo:rename_collection(?DBS, "examplee", "exam"), {ok, "true"}),
    ?_assertNotEqual(emongo:rename_collection(?DBS, "invoicex", "exam"), {{error, "target namespace exists: generic server error"}}),
    ?_assertNotEqual(emongo:rename_collection(?DBS, "invoicex", exm), {{error, "Invalid Collection Name: Invalid argument"}})
  ].

drop_collection_test_() ->
  [
    ?_assertEqual(emongo:drop_collection(?DBS, "exam"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "invoicexy"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "invoicey"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "invoicexyz"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "invoicex"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "invoicexa"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "examplex"), {ok, "true"}),
    ?_assertEqual(emongo:drop_collection(?DBS, "stud_info"), {ok, "true"})
  ].

drop_database_test_() ->
  [
    ?_assertEqual(emongo:drop_db(?DBS), {ok, "true"})
  ].

